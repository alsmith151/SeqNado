BootStrap: docker
From: python:3.12.9-alpine


%files
    MCCNado

%post

    # Install required packages
    apk add --update --no-cache curl git musl-dev gcc pkgconfig hdf5-dev make bash

    # # Install Rust
    curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y
    . "$HOME/.cargo/env"

    cargo --help

    # Install packages required
    pip install uv
    uv pip install maturin --system

    # Install minimap2
    git clone --recursive https://github.com/lh3/minimap2
    cd minimap2 && make
    cp minimap2 /usr/local/bin
    cd ..
    rm -rf minimap2

    # Use uv to install required packages
    # git clone https://github.com/alsmith151/MCCNado.git
    cd MCCNado
    uv pip install . cooler --system

    # Cleanup
    uv cache clean
    rustup self uninstall -y

    # Remove packages
    apk del --no-cache curl git musl-dev gcc pkgconfig

    





